# GitHub PR Dashboard - GitHub Pages Version

A static web application that migrates the Streamlit-based dashboard to GitHub Pages + Actions.

[Êó•Êú¨Ë™û](README.md) | English

## Overview

This directory contains a static PR dashboard that can be hosted on GitHub Pages.
GitHub Actions periodically fetches PR data and saves it as JSON files, which are visualized on static HTML pages.

### Key Features

- **Fully Static**: No server required, runs on GitHub Pages
- **Auto Update**: Daily automatic data fetching via GitHub Actions
- **Fast Display**: Instant display by loading local files
- **Modern UI**: Clean Streamlit-inspired design
- **Multi-Repository Support**: Manage multiple repositories in one place
- **Responsive Design**: Works on PC/Tablet/Mobile
- **Bilingual Support**: Japanese and English interface with language toggle
- **Dark Mode**: Theme switching support

### Available Pages

1. **üè† Home**: Repository selection and feature overview
2. **üìä PR Dashboard**: PR timeline visualization and action tracking
3. **üìà PR Analysis**: 7 analysis tabs (stagnation, blocker, reviewer, trend, bottleneck, speed, change patterns)
4. **üîë Four Keys**: Performance measurement using DORA Metrics
5. **üìä Statistics & Reports**: Comprehensive statistics and weekly report generation

## Directory Structure

```
Dashboard_pages/
‚îú‚îÄ‚îÄ index.html           # Main HTML file
‚îú‚îÄ‚îÄ css/
‚îÇ   ‚îî‚îÄ‚îÄ style.css       # Stylesheet (Streamlit-inspired design)
‚îú‚îÄ‚îÄ js/
‚îÇ   ‚îú‚îÄ‚îÄ config.js       # Configuration file
‚îÇ   ‚îú‚îÄ‚îÄ i18n.js         # Internationalization (Japanese/English)
‚îÇ   ‚îú‚îÄ‚îÄ app.js          # Main application logic
‚îÇ   ‚îú‚îÄ‚îÄ dashboard.js    # Dashboard page logic
‚îÇ   ‚îú‚îÄ‚îÄ analytics.js    # Analytics page logic (7 tabs)
‚îÇ   ‚îú‚îÄ‚îÄ fourkeys.js     # Four Keys page logic
‚îÇ   ‚îî‚îÄ‚îÄ statistics.js   # Statistics & Reports page logic
‚îú‚îÄ‚îÄ data/               # Generated JSON data (auto-generated by GitHub Actions)
‚îÇ   ‚îú‚îÄ‚îÄ config.json     # Repository configuration
‚îÇ   ‚îú‚îÄ‚îÄ prs.json        # PR data
‚îÇ   ‚îú‚îÄ‚îÄ analytics.json  # Analytics data
‚îÇ   ‚îú‚îÄ‚îÄ fourkeys.json   # Four Keys metrics data
‚îÇ   ‚îú‚îÄ‚îÄ statistics.json # Statistics & Reports data
‚îÇ   ‚îî‚îÄ‚îÄ cache_info.json # Cache information
‚îú‚îÄ‚îÄ generate_data.py    # Data generation script
‚îî‚îÄ‚îÄ README.md          # This file
```

## Setup

### Method 1: GitHub Actions Auto Deploy (Recommended)

1. **Update Repository Configuration**

   Edit `dashboard/config.py` to set your repositories:
   
   ```python
   REPOSITORIES = [
       {
           "name": "Your Project",
           "owner": "your-org",
           "repo": "your-repo"
       },
   ]
   ```

2. **Enable GitHub Pages**

   In your repository Settings > Pages:
   - Source: Select `GitHub Actions`
   - Save

3. **Configure GitHub Token and Permissions**

   **Important: Check Actions Permissions**
   
   The default `GITHUB_TOKEN` can be used to fetch PR data from public repositories.
   
   **Required Permissions:**
   - `contents: read` - Repository checkout (enabled by default)
   - `pages: write` - Deploy to GitHub Pages (already set in workflow)
   - `id-token: write` - GitHub Pages authentication (already set in workflow)
   
   **You need a Personal Access Token (PAT) if:**
   - Fetching PR data from private repositories
   - Additional permissions are needed for organization repositories
   - The default `GITHUB_TOKEN` has insufficient permissions
   
   **How to create a PAT:**
   1. Go to GitHub Settings > Developer settings > Personal access tokens > Tokens (classic)
   2. Click "Generate new token (classic)"
   3. Select required scopes:
      - `repo` (for private repositories)
      - `public_repo` (for public repositories)
   4. Generate and copy the token
   
   **Configure the PAT:**
   - Go to repository Settings > Secrets and variables > Actions
   - Click "New repository secret"
   - Name: `GH_PAT`
   - Value: Your generated Personal Access Token
   
   Then update lines 50-52 in `.github/workflows/deploy-pages.yml`:
   ```yaml
   - name: Fetch PR data from GitHub API
     env:
       GITHUB_TOKEN: ${{ secrets.GH_PAT }}  # ‚Üê Changed from secrets.GITHUB_TOKEN
   ```

4. **Run the Workflow**

   - Open the Actions tab
   - Select "Deploy GitHub PR Dashboard to Pages"
   - Click "Run workflow"

5. **Access the Dashboard**

   Access at `https://<username>.github.io/<repository>/`

### Method 2: Local Testing

#### Option A: Quick Start with Sample Data

1. **Use Sample Data**

   ```bash
   cd Dashboard_pages/data
   cp sample_prs.json prs.json
   ```

2. **Start Local Server**

   ```bash
   cd ..
   # Use Python's simple server
   python -m http.server 8000
   
   # Or Node.js http-server
   npx http-server
   ```

3. **Access in Browser**

   Open `http://localhost:8000`

#### Option B: Use Real Data

1. **Generate Data**

   ```bash
   # Fetch data from existing Streamlit dashboard
   cd dashboard
   python fetch_data.py --all
   
   # Generate static JSON files
   cd ../Dashboard_pages
   python generate_data.py
   ```

2. **Start Local Server**

   ```bash
   # Use Python's simple server
   python -m http.server 8000
   
   # Or Node.js http-server
   npx http-server
   ```

3. **Access in Browser**

   Open `http://localhost:8000`

## Configuration

### Change Monitored Repositories

Edit `dashboard/config.py`:

```python
REPOSITORIES = [
    {
        "name": "Display Name",
        "owner": "GitHub Owner",
        "repo": "Repository Name"
    },
    # Add more as needed
]
```

### Change Update Frequency

Edit the schedule in `.github/workflows/deploy-pages.yml`:

```yaml
schedule:
  # Daily at 2 AM (UTC)
  - cron: '0 2 * * *'
  
  # For hourly execution
  # - cron: '0 * * * *'
  
  # For weekly Monday at 2 AM
  # - cron: '0 2 * * 1'
```

### UI Customization

- **Colors**: `:root` section in `css/style.css`
- **Charts**: `charts` section in `js/config.js`
- **Default Display**: `ui` section in `js/config.js`
- **Language**: Use the language toggle button (EN/JA) in the UI

## Features

### Home Page

- Repository selection
- Cache status display
- Navigation to each page
- Language toggle (English/Japanese)

### PR Dashboard

- **PR Timeline**: Visualize PR lifecycle in Gantt chart format
- **Metrics**: Count of Open/Merged/Closed, average merge time
- **PR List**: Filterable detailed table

### PR Analytics

7 analysis tabs:

1. **Stagnation Analysis**: Distribution of open PR duration
2. **Blocker Analysis**: Estimate causes for unclosed PRs
3. **Reviewer Analysis**: Review activity
4. **Trend Analysis**: Weekly PR creation trends
5. **Bottleneck Analysis**: Identify long-stagnant PRs
6. **Review Speed**: Time analysis from creation to merge
7. **Change Pattern**: File change frequency and PR size

### Four Keys üÜï

DevOps Four Keys metrics measurement and visualization with **modern UI implementation**:

**‚ú® New Design:**
- Colorful metric cards with icons and gradients
- Color-coded by DORA levels (Elite: green, High: blue, Medium: yellow, Low: red)
- Hover animations and smooth transitions
- Responsive design for all devices

**üìä Four Key Metrics:**

1. **Deployment Frequency** - Measured based on merged PRs
2. **Lead Time for Changes** - Time from PR creation to merge
3. **Change Failure Rate** - Percentage of PRs with failure indicators
4. **Time to Restore Service (MTTR)** - Time to fix failure PRs

#### üìä Accurately Measurable Metrics

The following metrics can be **accurately measured** from PR data:

- ‚úÖ **Deployment Frequency**: Counts MERGED PRs as "deployments"
  - Assumption: PR merge = deployment
  - Unit: deployments per week
  
- ‚úÖ **Lead Time for Changes**: Time from PR creation to merge (median)
  - Unit: days
  - Note: Time from commit to PR creation is not included

#### ‚ö†Ô∏è Estimated Metrics

The following metrics are **estimated** from PR data:

- ‚ö†Ô∏è **Change Failure Rate**: PRs with the following keywords are classified as "failures"
  - Keywords: `revert`, `hotfix`, `urgent`, `fix`, `rollback`, `emergency`, `critical`
  - Limitation: May differ from actual incidents
  - Customizable: Keywords can be adjusted per project
  
- ‚ö†Ô∏è **Time to Restore Service (MTTR)**: Time from "failure" PR creation to merge (median)
  - Limitation: Differs from actual time from incident detection to recovery
  - Ideal: Integration with incident management systems recommended

#### üîß For More Accurate Measurement

For more accurate Four Keys measurement, integration with the following is recommended:

1. **CI/CD Systems**: Record actual deployment events
2. **Incident Management Tools**: PagerDuty, Opsgenie, etc.
3. **Monitoring Tools**: Record incident detection and recovery times
4. **Project-specific Labels/Tags**: Accurately identify failure PRs

#### üìà DORA Level Classification

Each metric is evaluated on a 4-level scale based on DORA (DevOps Research and Assessment) standards:

- **Elite**: Industry-leading performance
- **High**: High performance
- **Medium**: Medium performance
- **Low**: Needs improvement

#### References

- [DORA Research](https://www.devops-research.com/research.html)
- [Google Cloud - Four Keys Project](https://github.com/GoogleCloudPlatform/fourkeys)
- [Accelerate (book)](https://itrevolution.com/product/accelerate/)

### Statistics & Reports üìä

Provides comprehensive statistics to understand current development processes and find opportunities for improvement.

**üìÖ Period Summary:**
- Total PRs and merge rate
- Average lead time
- Active developers
- Comparison with previous period

**üìà Trend Analysis (Past 8 weeks):**
- PR creation trends
- Average lead time trends
- Visualization with charts

**üë• Review Activity:**
- Total reviews
- Total comments
- Averages per PR

**üí° Automated Insights:**
Automatically generates insights from statistical data:
- Detection of increased/decreased development activity
- Analysis of review speed improvements/delays
- Evaluation of merge rates
- Monitoring of review activity
- Alerts for stagnant PRs

**üéØ Improvement Suggestions:**
Proposes concrete improvement actions based on current issues:
- Methods to reduce review time
- Fostering review culture
- Strategies to improve PR completion rate
- Promoting team collaboration

**üìÑ Weekly Report Export:**
- Markdown-formatted report generation
- Summary of key metrics
- Comparison with previous week
- List of improvement suggestions
- Easy export with download button

## Data Flow

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  GitHub API         ‚îÇ
‚îÇ  (PR Data)          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îÇ
          ‚îÇ fetch_data.py
          ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  SQLite Cache       ‚îÇ
‚îÇ  (pr_cache.db)      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îÇ
          ‚îÇ generate_data.py
          ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  JSON Files         ‚îÇ
‚îÇ  (data/*.json)      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îÇ
          ‚îÇ JavaScript
          ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Dashboard UI       ‚îÇ
‚îÇ  (Browser Display)  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## Troubleshooting

### Data Not Displaying

1. Check if `data/prs.json` exists
2. Check browser console for errors
3. Check GitHub Actions logs

### GitHub Actions Failing

**Symptom:** "Fetch PR data from GitHub API" step fails

**Causes and Solutions:**

1. **Insufficient Permissions**
   - Error message contains "403 Forbidden" or "Resource not accessible by integration"
   - **Solution:** Create and configure a Personal Access Token (PAT) (see "Configure GitHub Token and Permissions" above)
   - Even for public repositories, organization repos may require additional permissions

2. **Repository Configuration**
   - Verify repository name and owner in `dashboard/config.py` are correct
   - Confirm the repository exists and is accessible

3. **Rate Limit**
   - Check if GitHub API rate limit has been reached
   - Default `GITHUB_TOKEN` allows 1,000 requests/hour
   - Using PAT increases limit to 5,000 requests/hour

4. **Actions Permissions Settings**
   - Go to repository Settings > Actions > General > Workflow permissions
   - "Read and write permissions" may be needed in some cases (usually not required)

### Page 404 Error

1. Verify GitHub Pages is enabled
2. Check if workflow completed successfully
3. Verify repository is public or GitHub Pages settings are correct

## Key Changes from Streamlit Version

| Feature | Streamlit Version | Pages Version |
|---------|------------------|---------------|
| Runtime | Local PC | GitHub Pages |
| Data Fetching | Manual/Scheduled | GitHub Actions (Automatic) |
| Display Method | Python/Streamlit | HTML/CSS/JavaScript |
| Updates | Real-time | Periodic (Default: Daily) |
| Interaction | Python-side processing | Client-side JavaScript |
| Charts | Plotly (Python) | Plotly.js |
| Language | Japanese only | Japanese/English toggle |

## Design

Follows these Streamlit design elements:

- Sidebar navigation
- Color scheme (Red/Green/Blue accent colors)
- Card-based layout
- Clean and minimal UI
- Responsive design
- Bilingual interface (Japanese/English)

## Security

- GitHub Token managed in GitHub Actions secrets
- Only static files published, no server-side processing
- Private repository data can be safely processed

## License

This project is provided under the same license as the original repository.

## Contributing

Bug reports and feature requests are welcome at [Issues](../../issues).

## Related Documentation

- [Original Streamlit Version README](../dashboard/README.md)
- [GitHub Pages Documentation](https://docs.github.com/en/pages)
- [GitHub Actions Documentation](https://docs.github.com/en/actions)
