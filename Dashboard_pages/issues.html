<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Issue管理 - GitHub PR Dashboard</title>
    <link rel="stylesheet" href="css/style.css?v=20251113-16">
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <script src="js/i18n.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1 data-i18n="github_pr_tools">GitHub PR Tools</h1>
                <div style="display: flex; gap: 0.5rem;">
                    <button id="themeToggle" class="theme-toggle" onclick="toggleTheme()" title="Toggle dark mode">
                        <span id="themeIcon">🌙</span>
                    </button>
                    <button id="langToggle" class="lang-toggle" onclick="toggleLanguage()">EN</button>
                </div>
            </div>

            <div class="sidebar-content">
                <!-- Repository Filter in Sidebar -->
                <div class="sidebar-filter">
                    <label for="globalRepoFilter" style="display: block; font-size: 0.85rem; color: var(--text-muted); margin-bottom: 0.5rem;">
                        📁 リポジトリフィルタ
                    </label>
                    <select id="globalRepoFilter" class="sidebar-select" onchange="handleGlobalRepoFilterChange()">
                        <option value="">すべてのリポジトリ</option>
                    </select>
                </div>

                <nav class="sidebar-nav">
                    <a href="index.html" class="nav-item" data-page="home">
                        <span class="nav-icon">🏠</span>
                        <span class="nav-label" data-i18n="nav.home">ホーム</span>
                    </a>
                    <a href="dashboard.html" class="nav-item" data-page="dashboard">
                        <span class="nav-icon">📊</span>
                        <span class="nav-label" data-i18n="nav.dashboard">PRダッシュボード</span>
                    </a>
                    <a href="analytics.html" class="nav-item" data-page="analytics">
                        <span class="nav-icon">📈</span>
                        <span class="nav-label" data-i18n="nav.analytics">PR分析</span>
                    </a>
                    <a href="fourkeys.html" class="nav-item" data-page="fourkeys">
                        <span class="nav-icon">🔑</span>
                        <span class="nav-label" data-i18n="nav.fourkeys">Four Keys</span>
                    </a>
                    <a href="statistics.html" class="nav-item" data-page="statistics">
                        <span class="nav-icon">📊</span>
                        <span class="nav-label" data-i18n="nav.statistics">統計・レポート</span>
                    </a>
                    <a href="file-history.html" class="nav-item" data-page="file-history">
                        <span class="nav-icon">📁</span>
                        <span class="nav-label" data-i18n="nav.filehistory">ファイル履歴</span>
                    </a>
                    <a href="issues.html" class="nav-item active" data-page="issues">
                        <span class="nav-icon">🎯</span>
                        <span class="nav-label" data-i18n="nav.issues">Issue管理</span>
                    </a>
                </nav>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Back Button - Hidden by default -->
            <button id="back-button" class="back-button" onclick="goBack()" style="display: none;">
                <span class="back-icon">←</span>
                <span class="back-label">戻る</span>
            </button>

            <!-- Global Repository Selection Info - Always Visible -->
            <div id="globalRepoInfo" class="global-repo-info">
                <div class="repo-info-content">
                    <span class="repo-info-icon">📁</span>
                    <span class="repo-info-label">現在のリポジトリ:</span>
                    <span id="globalRepoName" class="repo-info-name">すべてのリポジトリ</span>
                </div>
            </div>

            <!-- Issues Page -->
            <div id="page-issues" class="page active">
                <h1 data-i18n="issues.title">🎯 Issue管理・分析</h1>
                <p class="page-description" data-i18n="issues.description">
                    Issueの追跡、サイクルタイム分析、マイルストーン管理、チーム速度の可視化
                </p>

                <!-- Tabs -->
                <div class="tabs">
                    <button class="tab active" data-tab="overview" onclick="switchIssuesTab('overview')" data-i18n="issues.tab.overview">概要</button>
                    <button class="tab" data-tab="timeline" onclick="switchIssuesTab('timeline')" data-i18n="issues.tab.timeline">タイムライン</button>
                    <button class="tab" data-tab="cycle-time" onclick="switchIssuesTab('cycle-time')" data-i18n="issues.tab.cycle_time">サイクルタイム</button>
                    <button class="tab" data-tab="issue-pr-link" onclick="switchIssuesTab('issue-pr-link')" data-i18n="issues.tab.issue_pr">Issue-PR連携</button>
                    <button class="tab" data-tab="milestone" onclick="switchIssuesTab('milestone')" data-i18n="issues.tab.milestone">マイルストーン</button>
                    <button class="tab" data-tab="velocity" onclick="switchIssuesTab('velocity')" data-i18n="issues.tab.velocity">チーム速度</button>
                </div>

                <!-- Tab Content -->
                <div class="tab-content">
                    <!-- Overview Tab -->
                    <div id="tab-overview" class="tab-panel active">
                        <div id="issuesOverviewCharts">
                            <div class="loading">Loading...</div>
                        </div>
                    </div>

                    <!-- Timeline Tab -->
                    <div id="tab-timeline" class="tab-panel">
                        <div id="issuesTimelineChart">
                            <div class="loading">Loading...</div>
                        </div>
                    </div>

                    <!-- Cycle Time Tab -->
                    <div id="tab-cycle-time" class="tab-panel">
                        <div id="cycleTimeChart">
                            <div class="loading">Loading...</div>
                        </div>
                    </div>

                    <!-- Issue-PR Link Tab -->
                    <div id="tab-issue-pr-link" class="tab-panel">
                        <div id="issuePRLinkChart">
                            <div class="loading">Loading...</div>
                        </div>
                    </div>

                    <!-- Milestone Tab -->
                    <div id="tab-milestone" class="tab-panel">
                        <div id="milestoneChart">
                            <div class="loading">Loading...</div>
                        </div>
                    </div>

                    <!-- Velocity Tab -->
                    <div id="tab-velocity" class="tab-panel">
                        <div id="velocityChart">
                            <div class="loading">Loading...</div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="js/config.js?v=20251113-17"></script>
    <script src="js/utils.js?v=20251113-18"></script>
    <script src="js/action-tracker.js?v=20251113-18"></script>
    <script src="js/app.js?v=20251113-18"></script>
    <script src="js/issues.js?v=20251113-18"></script>
</body>
</html>